<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>C&D Barbershop ‚Äì G√§stebuch</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: #000;
  color: #fff;
  margin: 0;
  padding: 0;
}
.container {
  width: 90%;
  max-width: 700px;
  margin: 40px auto;
  background: rgba(255,255,255,0.05);
  border-radius: 15px;
  padding: 30px;
  box-shadow: 0 0 20px rgba(255,255,255,0.1);
}
label { font-weight: bold; display:block; margin-top:15px; }
input, textarea {
  width: 100%; padding: 10px; border-radius: 8px; border:none;
  margin-top:5px; font-size: 1em;
}
button {
  margin-top: 20px; padding: 12px; border:none; border-radius:8px;
  background:#fdd835; color:#000; font-weight:700; cursor:pointer;
}
button:hover { background:#ffeb3b; }
.entry {
  background: rgba(255,255,255,0.1);
  border-left: 4px solid #fdd835;
  padding: 10px;
  margin-top: 15px;
  border-radius: 8px;
}
.entry small { color: #aaa; }
.url-box {
  margin-top: 20px;
  font-size: 0.9em;
  color: #ccc;
  text-align: center;
}
.url-box a { color: #fdd835; word-break: break-all; }
</style>
</head>
<body>

<div class="container">
  <h1>‚≠ê G√§stebuch ‚Äì C&D Barbershop</h1>
  <p>Tragen Sie sich gerne ein ‚Äì Ihr Feedback ist uns wichtig!</p>

  <form id="guestbookForm">
    <label for="guestName">Name:</label>
    <input type="text" id="guestName" name="name" required>

    <label for="guestText">Nachricht:</label>
    <textarea id="guestText" name="text" required></textarea>

    <button type="submit">Eintrag senden</button>
  </form>

  <p id="successMsg" style="display:none; color:#0f0; margin-top:15px;">‚úÖ Vielen Dank f√ºr Ihren Eintrag!</p>

  <h2 style="margin-top:40px;">Eintr√§ge</h2>
  <div id="guestEntries">Lade Eintr√§ge...</div>

  <div class="url-box">
    <p>üì° Aktuelle Script-URL:</p>
    <a href="DEINE_WEB_APP_URL_HIER" target="_blank">DEINE_WEB_APP_URL_HIER</a>
  </div>
</div>

<script>
const sheetURL = "DEINE_WEB_APP_URL_HIER";
const guestEntriesDiv = document.getElementById('guestEntries');
const form = document.getElementById('guestbookForm');
const successMsg = document.getElementById('successMsg');

// === Eintr√§ge laden ===
async function loadEntries() {
  try {
    const res = await fetch(sheetURL);
    const data = await res.json();
    if (!data.length) {
      guestEntriesDiv.innerHTML = "<p>Noch keine Eintr√§ge vorhanden.</p>";
      return;
    }
    guestEntriesDiv.innerHTML = data.reverse().map(e => `
      <div class="entry">
        <strong>${e.name}</strong><br>
        <small>${new Date(e.date).toLocaleString('de-DE')}</small>
        <p>${e.text}</p>
      </div>
    `).join('');
  } catch (err) {
    guestEntriesDiv.innerHTML = "<p style='color:red;'>Fehler beim Laden der Eintr√§ge.</p>";
    console.error(err);
  }
}

// === Formular absenden ===
form.addEventListener('submit', async (e) => {
  e.preventDefault();
  const name = document.getElementById('guestName').value.trim();
  const text = document.getElementById('guestText').value.trim();

  if (!name || !text) return alert('Bitte alle Felder ausf√ºllen.');

  const formData = new FormData();
  formData.append('name', name);
  formData.append('text', text);

  try {
    await fetch(sheetURL, { method: 'POST', body: formData });
    successMsg.style.display = 'block';
    form.reset();
    setTimeout(() => { successMsg.style.display = 'none'; loadEntries(); }, 1500);
  } catch (err) {
    alert('Fehler beim Absenden.');
    console.error(err);
  }
});

document.addEventListener('DOMContentLoaded', loadEntries);
</script>
</body>
</html>
